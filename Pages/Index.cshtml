@page
@using Microsoft.AspNetCore.Http
@model IndexModel
@{
    ViewData["Title"] = "Forside";
    bool isAdminLoggedIn = HttpContext.Session.GetString("IsAdminLoggedIn") == "true";
}

<script>
    function confirmDeletion(event) {
        if (!confirm("Are you sure you want to delete this game?")) {
            event.preventDefault();
        }
    }
</script>

<div class="container mt-3">
    <!-- Featured Games Section -->
    <div class="row mb-3">
        <div class="col-12">
            <h2 class="featured-display">Udvalgte Spil</h2>
        </div>
        @foreach (var game in Model.Games.Where(g => g.Category == "featured"))
        {
            <div class="col-md-3 col-sm-6 mb-3">
                <div class="card">
                    <img class="card-img-top" src="~/css/Resources/Images/1.png" alt="@game.Title Image">
                    <div class="card-body">
                        <h5 class="card-title">@game.Title</h5>
                        <p class="card-text">@game.Description</p>
                        <button onclick="window.location.href='/Privacy?gameUrl=' + encodeURIComponent('@game.Link')" class="btn btn-primary">Spil Nu</button>
                        @if (isAdminLoggedIn)
                        {
                            <div class="button-container" style="display: flex; gap: 10px;">
                                <form method="post" asp-page-handler="EditGame" asp-route-id="@game.Id">
                                    <button type="submit" class="btn-success mt-2">Edit</button>
                                </form>
                                <form method="post" asp-page-handler="DeleteGame" asp-route-id="@game.Id">
                                    <button type="submit" class="btn-danger mt-2" onclick="confirmDeletion(event)">Delete</button>
                                </form>
                            </div>
                        }
                    </div>
                </div>
            </div>
        }
    </div>
    <!-- New Games Section -->
    <div class="row mb-3 new-games">
        <div class="col-12">
            <h3>Nye Spil</h3>
        </div>
        @foreach (var game in Model.Games.Where(g => g.Category == "new"))
        {
            <div class="col-md-3 col-sm-6 mb-3">
                <div class="card">
                    <img class="card-img-top" src="~/css/Resources/Images/1.png" alt="@game.Title Image">
                    <div class="card-body">
                        <h5 class="card-title">@game.Title</h5>
                        <p class="card-text">@game.Description</p>
                        <button onclick="window.location.href='/Privacy?gameUrl=' + encodeURIComponent('@game.Link')" class="btn btn-primary">Spil Nu</button>
                        @if (isAdminLoggedIn)
                        {
                            <div class="button-container" style="display: flex; gap: 10px;">
                                <form method="post" asp-page-handler="EditGame" asp-route-id="@game.Id">
                                    <button type="submit" class="btn-success mt-2">Edit</button>
                                </form>
                                <form method="post" asp-page-handler="DeleteGame" asp-route-id="@game.Id">
                                    <button type="submit" class="btn-danger mt-2" onclick="confirmDeletion(event)">Delete</button>
                                </form>
                            </div>
                        }
                    </div>
                </div>
            </div>
        }
    </div>
</div>